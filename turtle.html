<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Code Cadets Turtle</title>

  <!-- Pyodide -->
  <script src="https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js"></script>

  <!-- CodeMirror -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>

  <style>
    body { margin:0; padding:14px; font-family:system-ui; }
    h3 { margin:0 0 12px 0; }

    #layout {
      display: grid;
      grid-template-columns: 1.4fr 1fr;
      gap: 14px;
    }

    @media (max-width: 900px) {
      #layout { grid-template-columns: 1fr; }
      canvas { width: 100%; height: auto; }
    }

    /* =============================
       CodeMirror theme (ccbook)
       ============================= */

    .CodeMirror {
      height: 280px;
      border-radius: 12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: 14px;
      line-height: 1.25;
    }

    .cm-s-ccbook.CodeMirror {
      background: #2b2f3a;
      color: #e9eef7;
    }

    .cm-s-ccbook .CodeMirror-lines {
      padding: 8px 0;
    }

    .cm-s-ccbook .CodeMirror-line {
      padding-top: 0;
      padding-bottom: 0;
      line-height: 1.25;
    }

    /* ðŸ”§ THIS is the missing piece */
    .cm-s-ccbook .CodeMirror-measure,
    .cm-s-ccbook .CodeMirror-measure pre {
      line-height: 1.25 !important;
    }

    .cm-s-ccbook .CodeMirror-cursor {
      border-left: 2px solid #ffffff;
      height: 1.25em;
    }

    .cm-s-ccbook .CodeMirror-gutters {
      background: #262a34;
      border-right: 0;
    }

    .cm-s-ccbook .CodeMirror-linenumber {
      color: #7fd0c1;
      opacity: 0.75;
    }

    .cm-s-ccbook .cm-keyword { color: #ff4fd8; }
    .cm-s-ccbook .cm-variable { color: #e9eef7; }
    .cm-s-ccbook .cm-builtin { color: #cbd5e1; }
    .cm-s-ccbook .cm-string  { color: #bfe8ff; }
    .cm-s-ccbook .cm-number  { color: #ffd479; }
    .cm-s-ccbook .cm-comment { color: #a7b0c0; opacity: 0.75; }

    canvas {
      background:#fff;
      border:1px solid #ccc;
      border-radius:10px;
    }

    button {
      padding:8px 12px;
      border-radius:10px;
      border:1px solid #333;
      background:#111;
      color:#fff;
      cursor:pointer;
    }

    button.secondary {
      border:1px solid #999;
      background:#fff;
      color:#111;
    }

    #toolbar {
      display:flex;
      gap:10px;
      margin:10px 0;
      flex-wrap:wrap;
      align-items:center;
    }

    #status { font-size:14px; }

    pre {
      white-space: pre-wrap;
      background: #ffffff;
      color: #111111;
      padding: 10px;
      border-radius: 10px;
      margin: 0;
      min-height: 90px;
      border: 1px solid #d1d5db;
    }

    pre.err {
      background: #fff6f6;
      color: #7f1d1d;
      border: 1px solid #f0c0c0;
    }
  </style>
</head>

<body>
  <h3>Code Cadets â€“ Python Turtle</h3>

  <div id="layout">
    <div>
      <textarea id="code">from turtle import *
import time</textarea>

      <div id="toolbar">
        <button id="run" disabled>Run</button>
        <button id="toggleLines" class="secondary" disabled>Line numbers: ON</button>
        <button id="clearCanvas" class="secondary">Clear canvas</button>
        <button id="clearOut" class="secondary">Clear output</button>
        <span id="status">Loading Pythonâ€¦</span>
      </div>

      <pre id="out"></pre>
      <pre id="err" class="err"></pre>
    </div>

    <canvas id="canvas" width="520" height="520"></canvas>
  </div>

<script>
  const editor = CodeMirror.fromTextArea(document.getElementById("code"), {
    mode: "python",
    theme: "ccbook",
    lineNumbers: true,
    indentUnit: 2,
    tabSize: 2,
    viewportMargin: Infinity
  });
  editor.getWrapperElement().classList.add("cm-s-ccbook");

  let linesOn = true;
  document.getElementById("toggleLines").onclick = () => {
    linesOn = !linesOn;
    editor.setOption("lineNumbers", linesOn);
  };
</script>
</body>
</html>
